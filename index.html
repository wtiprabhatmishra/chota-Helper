<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Chhota Helper - Tumhara Super Project Dost</title>
    <style>
        body {
            font-family: 'Comic Sans MS', cursive;
            background: linear-gradient(135deg, #f0f8ff, #e6e6fa, #ffe4e1);
            text-align: center;
            margin: 0;
            padding: 20px;
            animation: fadeIn 1s ease-in;
            overflow-x: hidden;
            overflow-y: auto;
        }
        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
        h1 {
            color: #ff4500;
            font-size: 50px;
            text-shadow: 4px 4px #ffd700;
            animation: bounce 2s infinite;
        }
        @keyframes bounce {
            0%, 20%, 50%, 80%, 100% { transform: translateY(0); }
            40% { transform: translateY(-15px); }
            60% { transform: translateY(-7px); }
        }
        #chat-container {
            width: 75%;
            margin: 30px auto;
            background-color: #fffacd;
            padding: 30px;
            border-radius: 25px;
            box-shadow: 0 0 20px rgba(0, 0, 0, 0.4);
            position: relative;
            overflow: hidden; /* Ensure no overflow */
        }
        #chat-box {
            height: 400px;
            overflow-y: auto;
            background-color: #f0fff0;
            padding: 20px;
            border-radius: 15px;
            border: 4px solid #32cd32;
            margin-bottom: 20px;
        }
        .message {
            padding: 15px;
            margin: 10px;
            border-radius: 15px;
            animation: slideIn 0.5s ease-in;
            transition: all 0.3s ease;
        }
        .message:hover { transform: scale(1.02); }
        @keyframes slideIn { from { transform: translateX(-100%); opacity: 0; } to { transform: translateX(0); opacity: 1; } }
        .bot-message { background-color: #87cefa; color: #000; text-align: left; }
        .user-message { background-color: #ffb6c1; color: #000; text-align: right; }
        #input-area {
            display: flex;
            flex-direction: column;
            gap: 15px;
            justify-content: center;
            align-items: center;
        }
        #input-row, #options-row {
            display: flex;
            gap: 10px;
            justify-content: center;
            align-items: center;
            width: 100%;
        }
        #user-input {
            width: 60%;
            padding: 10px;
            border: 3px solid #ff69b4;
            border-radius: 15px;
            font-size: 18px;
            transition: border 0.3s ease;
        }
        #user-input:focus { border-color: #ff1493; outline: none; }
        #send-btn, #voice-btn, #lang-btn, #download-btn {
            padding: 8px 20px;
            background: linear-gradient(45deg, #ff69b4, #ff1493);
            color: white;
            border: none;
            border-radius: 12px;
            cursor: pointer;
            font-size: 16px;
            transition: transform 0.2s, box-shadow 0.2s;
        }
        #send-btn:hover, #voice-btn:hover, #lang-btn:hover, #download-btn:hover {
            transform: scale(1.1);
            box-shadow: 0 0 15px rgba(255, 20, 147, 0.7);
        }
        #progress-bar {
            width: 0%;
            height: 10px;
            background: linear-gradient(90deg, #32cd32, #ffd700);
            border-radius: 5px;
            margin: 10px auto;
            transition: width 2s ease;
            display: none;
        }
        footer {
            margin-top: 20px;
            font-size: 16px;
            color: #ff4500;
            text-shadow: 1px 1px #ffd700;
            padding-bottom: 20px;
        }
        footer a {
            color: #ff69b4;
            text-decoration: none;
        }
        footer a:hover {
            text-decoration: underline;
        }
    </style>
</head>
<body>
    <h1>Chhota Helper</h1>
    <div id="chat-container">
        <div id="chat-box">
            <div class="message bot-message" id="welcome-msg">
                Hello, chhote dost! Main hoon Chhota Helper ‚Äì tumhara super project dost! üåü<br>
                Batao: Class number aur Topic (e.g., "Class 5, Volcano")<br>
                Ya mic button dabao aur bolo! Main research karke sab doonga ‚Äì text, chart, aur image ideas!
            </div>
        </div>
        <div id="progress-bar"></div>
        <div id="input-area">
            <div id="input-row">
                <input type="text" id="user-input" placeholder="Class aur Topic likho...">
                <button id="send-btn" onclick="sendMessage()">Send</button>
            </div>
            <div id="options-row">
                <button id="voice-btn" onclick="startVoiceInput()">üé§</button>
                <button id="lang-btn" onclick="toggleLanguage()">Hindi</button>
                <button id="download-btn" onclick="downloadProject()">Download PDF</button>
            </div>
        </div>
    </div>
    <footer>
        Powered by <a href="http://webtechinfinity.com" target="_blank">webtechinfinity.com</a>
    </footer>

    <script>
        let isHindi = false;
        let lastResponse = "";

        function adjustLevel(classNum) {
            if (classNum >= 1 && classNum <= 2) return "simple";
            if (classNum >= 3 && classNum <= 5) return "medium";
            if (classNum >= 6 && classNum <= 8) return "detailed";
            return "invalid";
        }

        function toggleLanguage() {
            isHindi = !isHindi;
            document.getElementById("lang-btn").innerText = isHindi ? "English" : "Hindi";
            const welcomeMsg = isHindi ? 
                "‡§π‡§æ‡§Ø, ‡§õ‡•ã‡§ü‡•á ‡§¶‡•ã‡§∏‡•ç‡§§! ‡§Æ‡•à‡§Ç ‡§π‡•Ç‡§Å ‡§õ‡•ã‡§ü‡§æ ‡§π‡•á‡§≤‡•ç‡§™‡§∞ ‚Äì ‡§§‡•Å‡§Æ‡•ç‡§π‡§æ‡§∞‡§æ ‡§∏‡•Å‡§™‡§∞ ‡§™‡•ç‡§∞‡•ã‡§ú‡•á‡§ï‡•ç‡§ü ‡§¶‡•ã‡§∏‡•ç‡§§! üåü<br>‡§¨‡§§‡§æ‡§ì: ‡§ï‡•ç‡§≤‡§æ‡§∏ ‡§®‡§Ç‡§¨‡§∞ ‡§î‡§∞ ‡§ü‡•â‡§™‡§ø‡§ï (‡§ú‡•à‡§∏‡•á '‡§ï‡•ç‡§≤‡§æ‡§∏ 5, ‡§µ‡•ã‡§≤‡•ç‡§ï‡•á‡§®‡•ã')<br>‡§Ø‡§æ ‡§Æ‡§æ‡§á‡§ï ‡§¨‡§ü‡§® ‡§¶‡§¨‡§æ‡§ì ‡§î‡§∞ ‡§¨‡•ã‡§≤‡•ã! ‡§Æ‡•à‡§Ç ‡§∞‡§ø‡§∏‡§∞‡•ç‡§ö ‡§ï‡§∞‡§ï‡•á ‡§∏‡§¨ ‡§¶‡•Ç‡§Ç‡§ó‡§æ ‚Äì ‡§ü‡•á‡§ï‡•ç‡§∏‡•ç‡§ü, ‡§ö‡§æ‡§∞‡•ç‡§ü, ‡§î‡§∞ ‡§á‡§Æ‡•á‡§ú ‡§Ü‡§á‡§°‡§ø‡§Ø‡§æ‡§ú‡§º!" :
                "Hello, chhote dost! Main hoon Chhota Helper ‚Äì tumhara super project dost! üåü<br>Batao: Class number aur Topic (e.g., 'Class 5, Volcano')<br>Ya mic button dabao aur bolo! Main research karke sab doonga ‚Äì text, chart, aur image ideas!";
            document.getElementById("welcome-msg").innerHTML = welcomeMsg;
        }

        async function fetchWikipedia(topic) {
            const progressBar = document.getElementById("progress-bar");
            progressBar.style.display = "block";
            progressBar.style.width = "0%";
            setTimeout(() => progressBar.style.width = "100%", 100);
            
            const url = `https://en.wikipedia.org/w/api.php?action=query&prop=extracts&exintro&explaintext&format=json&titles=${encodeURIComponent(topic)}&origin=*`;
            try {
                addMessage(isHindi ? "‡§•‡•ã‡§°‡§º‡§æ ‡§∞‡•Å‡§ï‡•á‡§Ç, ‡§Æ‡•à‡§Ç ‡§∞‡§ø‡§∏‡§∞‡•ç‡§ö ‡§ï‡§∞ ‡§∞‡§π‡§æ ‡§π‡•Ç‡§Å..." : "Wait a sec, I‚Äôm researching...", "bot-message");
                const response = await fetch(url);
                const data = await response.json();
                const pages = data.query.pages;
                const pageId = Object.keys(pages)[0];
                if (pageId === "-1" || !pages[pageId].extract) {
                    return null;
                }
                const extract = pages[pageId].extract;
                progressBar.style.display = "none";
                return extract.split(". ").map(s => s + ".");
            } catch (error) {
                progressBar.style.display = "none";
                return null;
            }
        }

        function generateResponse(classNum, topic, level, sentences) {
            const langSuffix = isHindi ? "hi" : "en";
            let text, chart, image;

            if (sentences) {
                if (level === "simple") {
                    text = sentences[0];
                } else if (level === "medium") {
                    text = sentences.slice(0, 2).join(" ");
                } else {
                    text = sentences.slice(0, 4).join(" ");
                }
            } else {
                text = isHindi ? 
                    `${topic} ‡§ï‡•á ‡§¨‡§æ‡§∞‡•á ‡§Æ‡•á‡§Ç ‡§ï‡•Å‡§õ ‡§Æ‡§ú‡§º‡•á‡§¶‡§æ‡§∞ ‡§¨‡§æ‡§§‡•á‡§Ç ‡§π‡•à‡§Ç ‡§ú‡•ã ‡§§‡•Å‡§Æ ‡§∏‡•Ä‡§ñ ‡§∏‡§ï‡§§‡•á ‡§π‡•ã‡•§` : 
                    `There are some fun things to learn about ${topic}.`;
            }

            if (topic.toLowerCase().includes("volcano") || topic.toLowerCase().includes("earth") || topic.toLowerCase().includes("plant")) {
                chart = level === "simple" ? 
                    (isHindi ? `${topic} ‡§ï‡§æ ‡§è‡§ï ‡§õ‡•ã‡§ü‡§æ ‡§ö‡§ø‡§§‡•ç‡§∞ ‡§¨‡§®‡§æ‡§ì‡•§` : `Draw a small ${topic} picture.`) :
                    level === "medium" ? 
                    (isHindi ? `${topic} ‡§ï‡§æ ‡§ö‡§ø‡§§‡•ç‡§∞ ‡§¨‡§®‡§æ‡§ì ‡§î‡§∞ 2 ‡§ö‡•Ä‡§ú‡§º‡•á‡§Ç ‡§®‡§æ‡§Æ ‡§¶‡•ã‡•§` : `Draw ${topic} and label 2 parts.`) :
                    (isHindi ? `${topic} ‡§ï‡§æ ‡§™‡•Ç‡§∞‡§æ ‡§ö‡§ø‡§§‡•ç‡§∞ ‡§¨‡§®‡§æ‡§ì, ‡§∞‡§Ç‡§ó‡•ã‡§Ç ‡§î‡§∞ ‡§®‡§æ‡§Æ‡•ã‡§Ç ‡§ï‡•á ‡§∏‡§æ‡§•‡•§` : `Draw a full ${topic} diagram with colors and labels.`);
                image = isHindi ? `${topic} ‡§ï‡•Ä ‡§è‡§ï ‡§∂‡§æ‡§®‡§¶‡§æ‡§∞ ‡§§‡§∏‡•ç‡§µ‡•Ä‡§∞ ‡§¢‡•Ç‡§Ç‡§¢‡•ã‡•§` : `Find a cool picture of ${topic}.`;
            } else if (topic.toLowerCase().includes("fraction") || topic.toLowerCase().includes("number") || topic.toLowerCase().includes("math")) {
                chart = level === "simple" ? 
                    (isHindi ? `${topic} ‡§ï‡§æ ‡§è‡§ï ‡§Ü‡§∏‡§æ‡§® ‡§ü‡•á‡§¨‡§≤ ‡§¨‡§®‡§æ‡§ì‡•§` : `Make a simple ${topic} table.`) :
                    level === "medium" ? 
                    (isHindi ? `${topic} ‡§ï‡§æ ‡§ü‡•á‡§¨‡§≤ ‡§¨‡§®‡§æ‡§ì ‡§î‡§∞ 3 ‡§â‡§¶‡§æ‡§π‡§∞‡§£ ‡§¶‡•ã‡•§` : `Draw a ${topic} table with 3 examples.`) :
                    (isHindi ? `${topic} ‡§ï‡§æ ‡§ó‡•ç‡§∞‡§æ‡§´ ‡§¨‡§®‡§æ‡§ì ‡§î‡§∞ 5 ‡§â‡§¶‡§æ‡§π‡§∞‡§£‡•ã‡§Ç ‡§ï‡•á ‡§∏‡§æ‡§• ‡§∏‡§Æ‡§ù‡§æ‡§ì‡•§` : `Create a ${topic} graph and explain with 5 examples.`);
                image = isHindi ? `${topic} ‡§ï‡§æ ‡§è‡§ï ‡§∞‡§Ç‡§ó‡•Ä‡§® ‡§ö‡§æ‡§∞‡•ç‡§ü ‡§¢‡•Ç‡§Ç‡§¢‡•ã‡•§` : `Find a colorful ${topic} chart.`;
            } else {
                chart = level === "simple" ? 
                    (isHindi ? `${topic} ‡§ï‡§æ ‡§è‡§ï ‡§Ü‡§∏‡§æ‡§® ‡§®‡§ï‡•ç‡§∂‡§æ ‡§¨‡§®‡§æ‡§ì‡•§` : `Draw a simple ${topic} map.`) :
                    level === "medium" ? 
                    (isHindi ? `${topic} ‡§ï‡§æ ‡§®‡§ï‡•ç‡§∂‡§æ ‡§¨‡§®‡§æ‡§ì ‡§î‡§∞ 2 ‡§ú‡§ó‡§π‡•á‡§Ç ‡§¶‡§ø‡§ñ‡§æ‡§ì‡•§` : `Make a ${topic} map with 2 places.`) :
                    (isHindi ? `${topic} ‡§ï‡§æ ‡§µ‡§ø‡§∏‡•ç‡§§‡•É‡§§ ‡§®‡§ï‡•ç‡§∂‡§æ ‡§Ø‡§æ ‡§ü‡§æ‡§á‡§Æ‡§≤‡§æ‡§á‡§® ‡§¨‡§®‡§æ‡§ì, ‡§∞‡§Ç‡§ó‡•ã‡§Ç ‡§ï‡•á ‡§∏‡§æ‡§•„ÄÇ` : `Create a detailed ${topic} map or timeline with colors.`);
                image = isHindi ? `${topic} ‡§ï‡§æ ‡§è‡§ï ‡§∏‡•Å‡§Ç‡§¶‡§∞ ‡§´‡•ã‡§ü‡•ã ‡§Ø‡§æ ‡§®‡§ï‡•ç‡§∂‡§æ ‡§¢‡•Ç‡§Ç‡§¢‡•ã„ÄÇ` : `Find a beautiful ${topic} photo or map.`;
            }

            const tips = isHindi ? 
                ["‡§∞‡•ã‡§ú‡§º 10 ‡§Æ‡§ø‡§®‡§ü ‡§™‡§¢‡§º‡§æ‡§à ‡§ï‡§∞‡•ã, ‡§Æ‡§ú‡§º‡§æ ‡§Ü‡§è‡§ó‡§æ!", "‡§∞‡§Ç‡§ó‡•ã‡§Ç ‡§∏‡•á ‡§∏‡•Ä‡§ñ‡§®‡§æ ‡§Ü‡§∏‡§æ‡§® ‡§π‡•ã‡§§‡§æ ‡§π‡•à!", "‡§Ö‡§™‡§®‡•á ‡§¶‡•ã‡§∏‡•ç‡§§‡•ã‡§Ç ‡§ï‡•á ‡§∏‡§æ‡§• ‡§™‡•ç‡§∞‡•ã‡§ú‡•á‡§ï‡•ç‡§ü ‡§∂‡•á‡§Ø‡§∞ ‡§ï‡§∞‡•ã!"] :
                ["Study 10 minutes daily, it‚Äôs fun!", "Use colors to learn faster!", "Share your project with friends!"];
            const randomTip = tips[Math.floor(Math.random() * tips.length)];

            return { text, chart, image, tip: randomTip };
        }

        async function sendMessage() {
            const userInput = document.getElementById("user-input").value.trim().toLowerCase();
            if (!userInput) return;

            addMessage(userInput, "user-message");
            document.getElementById("user-input").value = "";

            if (userInput === "bye") {
                addMessage(isHindi ? "‡§¨‡§æ‡§Ø-‡§¨‡§æ‡§Ø! ‡§™‡•ç‡§∞‡•ã‡§ú‡•á‡§ï‡•ç‡§ü ‡§Æ‡•á‡§Ç ‡§Æ‡§ú‡§º‡•á ‡§ï‡§∞‡•ã!" : "Bye-bye! Project mein maza karna!", "bot-message");
                return;
            }

            try {
                const parts = userInput.split(",");
                const classNum = parseInt(parts[0].replace("class", "").trim());
                const topic = parts[1].trim().charAt(0).toUpperCase() + parts[1].trim().slice(1);

                const level = adjustLevel(classNum);
                if (level === "invalid") {
                    addMessage(isHindi ? "‡§ï‡•ç‡§≤‡§æ‡§∏ 1 ‡§∏‡•á 8 ‡§§‡§ï ‡§π‡•Ä ‡§¨‡•ã‡§≤‡•ã!" : "Class 1 se 8 tak hi bolo!", "bot-message");
                    return;
                }

                let response = isHindi ? 
                    `‡§π‡§æ‡§Ø, ‡§õ‡•ã‡§ü‡•á ‡§¶‡•ã‡§∏‡•ç‡§§! ‡§Ø‡•á ‡§∞‡§π‡§æ ‡§§‡•Å‡§Æ‡•ç‡§π‡§æ‡§∞‡§æ ${topic} ‡§ï‡§æ ‡§™‡•ç‡§∞‡•ã‡§ú‡•á‡§ï‡•ç‡§ü (‡§ï‡•ç‡§≤‡§æ‡§∏ ${classNum}):<br>` :
                    `Hello, chhote dost! Yeh raha tumhara ${topic} ka project (Class ${classNum}):<br>`;

                const researchData = await fetchWikipedia(topic);
                const content = generateResponse(classNum, topic, level, researchData);

                response += `<strong>Text:</strong> ${content.text}<br>`;
                response += `<strong>Chart:</strong> ${content.chart}<br>`;
                response += `<strong>${isHindi ? "‡§á‡§Æ‡•á‡§ú ‡§Ü‡§á‡§°‡§ø‡§Ø‡§æ" : "Image Idea"}:</strong> ${content.image}<br>`;
                response += `<strong>${isHindi ? "‡§ü‡§ø‡§™" : "Tip"}:</strong> ${content.tip}<br>`;

                lastResponse = response;
                addMessage(response, "bot-message");
            } catch (e) {
                addMessage(isHindi ? "‡§ï‡•Å‡§õ ‡§ó‡§≤‡§§ ‡§¨‡•ã‡§≤‡§æ ‡§§‡•Å‡§Æne, ‡§†‡•Ä‡§ï ‡§∏‡•á ‡§¨‡•ã‡§≤‡•ã ‡§ú‡•à‡§∏‡•á 'Class 5, Volcano'!" : 
                    "Kuch galat bola tumne, thik se bolo jaise 'Class 5, Volcano'!", "bot-message");
            }
        }

        function startVoiceInput() {
            const recognition = new (window.SpeechRecognition || window.webkitSpeechRecognition)();
            recognition.lang = isHindi ? "hi-IN" : "en-US";
            recognition.onresult = (event) => {
                const transcript = event.results[0][0].transcript;
                document.getElementById("user-input").value = transcript;
                sendMessage();
            };
            recognition.onerror = () => addMessage(isHindi ? "‡§Ü‡§µ‡§æ‡§ú‡§º ‡§®‡§π‡•Ä‡§Ç ‡§∏‡•Å‡§® ‡§™‡§æ‡§Ø‡§æ!" : "Couldn‚Äôt hear you!", "bot-message");
            recognition.start();
        }

        function downloadProject() {
            if (!lastResponse) {
                addMessage(isHindi ? "‡§™‡§π‡§≤‡•á ‡§™‡•ç‡§∞‡•ã‡§ú‡•á‡§ï‡•ç‡§ü ‡§¨‡§®‡§æ‡§ì!" : "Make a project first!", "bot-message");
                return;
            }
            try {
                const { jsPDF } = window.jspdf;
                if (!jsPDF) {
                    addMessage(isHindi ? "PDF ‡§°‡§æ‡§â‡§®‡§≤‡•ã‡§° ‡§ï‡•á ‡§≤‡§ø‡§è ‡§á‡§Ç‡§ü‡§∞‡§®‡•á‡§ü ‡§ö‡§æ‡§π‡§ø‡§è!" : "Internet needed for PDF download!", "bot-message");
                    return;
                }
                const doc = new jsPDF();
                doc.setFont("helvetica");
                doc.setFontSize(12);
                doc.text(lastResponse.replace(/<br>/g, "\n").replace(/<strong>|<\/strong>/g, ""), 10, 10);
                doc.save("Chhota_Helper_Project.pdf");
            } catch (e) {
                addMessage(isHindi ? "PDF ‡§¨‡§®‡§æ‡§®‡•á ‡§Æ‡•á‡§Ç ‡§¶‡§ø‡§ï‡•ç‡§ï‡§§ ‡§π‡•Å‡§à, ‡§¶‡•ã‡§¨‡§æ‡§∞‡§æ ‡§Ü‡§ú‡§Æ‡§æ‡§è‡§Ç!" : "Error creating PDF, try again!", "bot-message");
            }
        }

        function addMessage(text, className) {
            const chatBox = document.getElementById("chat-box");
            const messageDiv = document.createElement("div");
            messageDiv.className = `message ${className}`;
            messageDiv.innerHTML = text;
            chatBox.appendChild(messageDiv);
            chatBox.scrollTop = chatBox.scrollHeight;
        }

        document.getElementById("user-input").addEventListener("keypress", function(e) {
            if (e.key === "Enter") sendMessage();
        });
    </script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
</body>
</html>
